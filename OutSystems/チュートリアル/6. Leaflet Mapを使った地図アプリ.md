# 検索した住所で地図上にピンを立ててみよう
[前章](https://github.com/taijihagino/low-code-dev/blob/main/OutSystems/%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB/5.%20REST%20API%E3%81%AE%E5%88%A9%E7%94%A8.md)では、郵便番号をパラメーターにして住所データ取得のAPIを呼び出し、その戻り値からいくつかの値をポップアップで表示する、ということを実装しました。

ここでは、その検索結果のデータを使って、地図上にピンを立てるというアプリを実装していきます。

## Leaflet Mapの配置
１．前章で作成したInputフォームにPromptを設定します。ここでは「郵便番号」としました。

![Screenshot 2024-01-18 at 9 37 24](https://github.com/taijihagino/low-code-dev/assets/12064399/27a2863e-20a5-4296-9d4d-f4bb870d46b9)

２．Mapエレメントを配置します。OutSystemsのデフォルトはGoogle Mapですが、ここではもう少し使いやすいLeaflet Mapを使用します。

IDE右上の検索窓に「Leaflet」と入力し、「Search in other Modules」を選択します。

![Screenshot 2024-01-18 at 9 38 37](https://github.com/taijihagino/low-code-dev/assets/12064399/ae59e9e6-13a7-4fc8-bb2f-9bdd8eb45fcc)

３．検索結果から「Leaflet Map」を選択し、「Add Dependency」ボタンをクリックします。これは、本来このアプリに関連付いていないLeaflet Mapモジュールを関連付けるための手順になります。

![Screenshot 2024-01-18 at 9 39 30](https://github.com/taijihagino/low-code-dev/assets/12064399/993af694-4dd1-4bed-8557-d0a158efadbf)

これで、このアプリ内でLeaflet Mapが使えるようになりました。

４．InterfaceタブのModule → UI Flows → OutSystemsMaps → Maps配下の「Leaflet Map」をドラッグ＆ドロップでInputフォームの下あたりに配置します。

![Screenshot 2024-01-18 at 9 40 23](https://github.com/taijihagino/low-code-dev/assets/12064399/90edb209-0424-40c9-8963-96611cf60abf)

５．配置されたMapのレイアウトを少し調整します。Map上で右クリックし、「Enclose in Container」を選択します。これにより、コンテナとしてレイアウト調整ができるようになります。

![Screenshot 2024-01-18 at 9 41 38](https://github.com/taijihagino/low-code-dev/assets/12064399/ee59933c-f912-4c41-8976-55d43fa7e8c2)

６．Containerが選択されていることを確認して、IDR右下のStylesタブを選択します。LayoutのMarginでTopの外側マージンを20pxに設定します。

![Screenshot 2024-01-18 at 9 42 26](https://github.com/taijihagino/low-code-dev/assets/12064399/b837097e-a941-4e15-a48b-909a76e8dc11)

Mapの配置は、一旦これで完了となります。

## ボタンアクションに緯度経度情報を追加

## Map上に表示するマーカーの準備

## マーカーをクリアする処理の実装

